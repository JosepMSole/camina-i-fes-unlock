(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}})();const Be="modulepreload",Te=function(t){return"/"+t},ie={},me=function(e,n,i){let s=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),c=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));s=Promise.allSettled(n.map(d=>{if(d=Te(d),d in ie)return;ie[d]=!0;const u=d.endsWith(".css"),w=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${w}`))return;const f=document.createElement("link");if(f.rel=u?"stylesheet":Be,u||(f.as="script"),f.crossOrigin="",f.href=d,c&&f.setAttribute("nonce",c),document.head.appendChild(f),u)return new Promise((E,T)=>{f.addEventListener("load",E),f.addEventListener("error",()=>T(new Error(`Unable to preload CSS for ${d}`)))})}))}function o(l){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=l,window.dispatchEvent(c),!c.defaultPrevented)throw l}return s.then(l=>{for(const c of l||[])c.status==="rejected"&&o(c.reason);return e().catch(o)})};/*! Capacitor: https://capacitorjs.com/ - MIT License */const _e=t=>{const e=new Map;e.set("web",{name:"web"});const n=t.CapacitorPlatforms||{currentPlatform:{name:"web"},platforms:e},i=(o,l)=>{n.platforms.set(o,l)},s=o=>{n.platforms.has(o)&&(n.currentPlatform=n.platforms.get(o))};return n.addPlatform=i,n.setPlatform=s,n},$e=t=>t.CapacitorPlatforms=_e(t),fe=$e(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});fe.addPlatform;fe.setPlatform;var j;(function(t){t.Unimplemented="UNIMPLEMENTED",t.Unavailable="UNAVAILABLE"})(j||(j={}));class X extends Error{constructor(e,n,i){super(e),this.message=e,this.code=n,this.data=i}}const je=t=>{var e,n;return t!=null&&t.androidBridge?"android":!((n=(e=t==null?void 0:t.webkit)===null||e===void 0?void 0:e.messageHandlers)===null||n===void 0)&&n.bridge?"ios":"web"},Re=t=>{var e,n,i,s,o;const l=t.CapacitorCustomPlatform||null,c=t.Capacitor||{},d=c.Plugins=c.Plugins||{},u=t.CapacitorPlatforms,w=()=>l!==null?l.name:je(t),f=((e=u==null?void 0:u.currentPlatform)===null||e===void 0?void 0:e.getPlatform)||w,E=()=>f()!=="web",T=((n=u==null?void 0:u.currentPlatform)===null||n===void 0?void 0:n.isNativePlatform)||E,Pe=g=>{const m=J.get(g);return!!(m!=null&&m.platforms.has(f())||re(g))},Ie=((i=u==null?void 0:u.currentPlatform)===null||i===void 0?void 0:i.isPluginAvailable)||Pe,Le=g=>{var m;return(m=c.PluginHeaders)===null||m===void 0?void 0:m.find(_=>_.name===g)},re=((s=u==null?void 0:u.currentPlatform)===null||s===void 0?void 0:s.getPluginHeader)||Le,Me=g=>t.console.error(g),ke=(g,m,_)=>Promise.reject(`${_} does not have an implementation of "${m}".`),J=new Map,Se=(g,m={})=>{const _=J.get(g);if(_)return console.warn(`Capacitor plugin "${g}" already registered. Cannot register plugins twice.`),_.proxy;const x=f(),$=re(g);let M;const xe=async()=>(!M&&x in m?M=typeof m[x]=="function"?M=await m[x]():M=m[x]:l!==null&&!M&&"web"in m&&(M=typeof m.web=="function"?M=await m.web():M=m.web),M),Ae=(h,v)=>{var P,S;if($){const C=$==null?void 0:$.methods.find(b=>v===b.name);if(C)return C.rtype==="promise"?b=>c.nativePromise(g,v.toString(),b):(b,W)=>c.nativeCallback(g,v.toString(),b,W);if(h)return(P=h[v])===null||P===void 0?void 0:P.bind(h)}else{if(h)return(S=h[v])===null||S===void 0?void 0:S.bind(h);throw new X(`"${g}" plugin is not implemented on ${x}`,j.Unimplemented)}},Y=h=>{let v;const P=(...S)=>{const C=xe().then(b=>{const W=Ae(b,h);if(W){const q=W(...S);return v=q==null?void 0:q.remove,q}else throw new X(`"${g}.${h}()" is not implemented on ${x}`,j.Unimplemented)});return h==="addListener"&&(C.remove=async()=>v()),C};return P.toString=()=>`${h.toString()}() { [capacitor code] }`,Object.defineProperty(P,"name",{value:h,writable:!1,configurable:!1}),P},oe=Y("addListener"),se=Y("removeListener"),Oe=(h,v)=>{const P=oe({eventName:h},v),S=async()=>{const b=await P;se({eventName:h,callbackId:b},v)},C=new Promise(b=>P.then(()=>b({remove:S})));return C.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await S()},C},Q=new Proxy({},{get(h,v){switch(v){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return $?Oe:oe;case"removeListener":return se;default:return Y(v)}}});return d[g]=Q,J.set(g,{name:g,proxy:Q,platforms:new Set([...Object.keys(m),...$?[x]:[]])}),Q},Ce=((o=u==null?void 0:u.currentPlatform)===null||o===void 0?void 0:o.registerPlugin)||Se;return c.convertFileSrc||(c.convertFileSrc=g=>g),c.getPlatform=f,c.handleError=Me,c.isNativePlatform=T,c.isPluginAvailable=Ie,c.pluginMethodNoop=ke,c.registerPlugin=Ce,c.Exception=X,c.DEBUG=!!c.DEBUG,c.isLoggingEnabled=!!c.isLoggingEnabled,c.platform=c.getPlatform(),c.isNative=c.isNativePlatform(),c},Ue=t=>t.Capacitor=Re(t),V=Ue(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),N=V.registerPlugin;V.Plugins;class he{constructor(e){this.listeners={},this.retainedEventArguments={},this.windowListeners={},e&&(console.warn(`Capacitor WebPlugin "${e.name}" config object was deprecated in v3 and will be removed in v4.`),this.config=e)}addListener(e,n){let i=!1;this.listeners[e]||(this.listeners[e]=[],i=!0),this.listeners[e].push(n);const o=this.windowListeners[e];o&&!o.registered&&this.addWindowListener(o),i&&this.sendRetainedArgumentsForEvent(e);const l=async()=>this.removeListener(e,n);return Promise.resolve({remove:l})}async removeAllListeners(){this.listeners={};for(const e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,n,i){const s=this.listeners[e];if(!s){if(i){let o=this.retainedEventArguments[e];o||(o=[]),o.push(n),this.retainedEventArguments[e]=o}return}s.forEach(o=>o(n))}hasListeners(e){return!!this.listeners[e].length}registerWindowListener(e,n){this.windowListeners[n]={registered:!1,windowEventName:e,pluginEventName:n,handler:i=>{this.notifyListeners(n,i)}}}unimplemented(e="not implemented"){return new V.Exception(e,j.Unimplemented)}unavailable(e="not available"){return new V.Exception(e,j.Unavailable)}async removeListener(e,n){const i=this.listeners[e];if(!i)return;const s=i.indexOf(n);this.listeners[e].splice(s,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){const n=this.retainedEventArguments[e];n&&(delete this.retainedEventArguments[e],n.forEach(i=>{this.notifyListeners(e,i)}))}}const ae=t=>encodeURIComponent(t).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),ce=t=>t.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class He extends he{async getCookies(){const e=document.cookie,n={};return e.split(";").forEach(i=>{if(i.length<=0)return;let[s,o]=i.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");s=ce(s).trim(),o=ce(o).trim(),n[s]=o}),n}async setCookie(e){try{const n=ae(e.key),i=ae(e.value),s=`; expires=${(e.expires||"").replace("expires=","")}`,o=(e.path||"/").replace("path=",""),l=e.url!=null&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${n}=${i||""}${s}; path=${o}; ${l};`}catch(n){return Promise.reject(n)}}async deleteCookie(e){try{document.cookie=`${e.key}=; Max-Age=0`}catch(n){return Promise.reject(n)}}async clearCookies(){try{const e=document.cookie.split(";")||[];for(const n of e)document.cookie=n.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}}N("CapacitorCookies",{web:()=>new He});const Ge=async t=>new Promise((e,n)=>{const i=new FileReader;i.onload=()=>{const s=i.result;e(s.indexOf(",")>=0?s.split(",")[1]:s)},i.onerror=s=>n(s),i.readAsDataURL(t)}),De=(t={})=>{const e=Object.keys(t);return Object.keys(t).map(s=>s.toLocaleLowerCase()).reduce((s,o,l)=>(s[o]=t[e[l]],s),{})},We=(t,e=!0)=>t?Object.entries(t).reduce((i,s)=>{const[o,l]=s;let c,d;return Array.isArray(l)?(d="",l.forEach(u=>{c=e?encodeURIComponent(u):u,d+=`${o}=${c}&`}),d.slice(0,-1)):(c=e?encodeURIComponent(l):l,d=`${o}=${c}`),`${i}&${d}`},"").substr(1):null,qe=(t,e={})=>{const n=Object.assign({method:t.method||"GET",headers:t.headers},e),s=De(t.headers)["content-type"]||"";if(typeof t.data=="string")n.body=t.data;else if(s.includes("application/x-www-form-urlencoded")){const o=new URLSearchParams;for(const[l,c]of Object.entries(t.data||{}))o.set(l,c);n.body=o.toString()}else if(s.includes("multipart/form-data")||t.data instanceof FormData){const o=new FormData;if(t.data instanceof FormData)t.data.forEach((c,d)=>{o.append(d,c)});else for(const c of Object.keys(t.data))o.append(c,t.data[c]);n.body=o;const l=new Headers(n.headers);l.delete("content-type"),n.headers=l}else(s.includes("application/json")||typeof t.data=="object")&&(n.body=JSON.stringify(t.data));return n};class Fe extends he{async request(e){const n=qe(e,e.webFetchExtra),i=We(e.params,e.shouldEncodeUrlParams),s=i?`${e.url}?${i}`:e.url,o=await fetch(s,n),l=o.headers.get("content-type")||"";let{responseType:c="text"}=o.ok?e:{};l.includes("application/json")&&(c="json");let d,u;switch(c){case"arraybuffer":case"blob":u=await o.blob(),d=await Ge(u);break;case"json":d=await o.json();break;case"document":case"text":default:d=await o.text()}const w={};return o.headers.forEach((f,E)=>{w[E]=f}),{data:d,headers:w,status:o.status,url:o.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))}}N("CapacitorHttp",{web:()=>new Fe});const le=N("Geolocation",{web:()=>me(()=>import("./web-B2c54RoS.js"),[]).then(t=>new t.GeolocationWeb)});var H;(function(t){t.Heavy="HEAVY",t.Medium="MEDIUM",t.Light="LIGHT"})(H||(H={}));var de;(function(t){t.Success="SUCCESS",t.Warning="WARNING",t.Error="ERROR"})(de||(de={}));const z=N("Haptics",{web:()=>me(()=>import("./web-CDjJUfZw.js"),[]).then(t=>new t.HapticsWeb)}),R=500,p=[{id:"01",src:"/img/imatge01.jpg"},{id:"02",src:"/img/imatge02.jpg"},{id:"03",src:"/img/imatge03.jpg"},{id:"04",src:"/img/imatge04.jpg"},{id:"05",src:"/img/imatge05.jpg"}],ve="walkunlock_settings_v1",ye="walkunlock_progress_v1",pe="walkunlock_active_v1",a={canvas:document.getElementById("canvas"),txtActiveImage:document.getElementById("txtActiveImage"),txtMeters:document.getElementById("txtMeters"),txtPercent:document.getElementById("txtPercent"),badgeStatus:document.getElementById("badgeStatus"),btnStartStop:document.getElementById("btnStartStop"),btnReset:document.getElementById("btnReset"),btnNext:document.getElementById("btnNext"),btnSettings:document.getElementById("btnSettings"),settingsPanel:document.getElementById("settingsPanel"),btnCloseSettings:document.getElementById("btnCloseSettings"),togDarkMode:document.getElementById("togDarkMode"),togHaptics:document.getElementById("togHaptics"),togDemoMode:document.getElementById("togDemoMode"),selTileSize:document.getElementById("selTileSize"),demoControls:document.getElementById("demoControls"),btnAdd50:document.getElementById("btnAdd50"),btnAdd200:document.getElementById("btnAdd200"),btnGallery:document.getElementById("btnGallery"),galleryModal:document.getElementById("galleryModal"),btnCloseGallery:document.getElementById("btnCloseGallery"),galleryGrid:document.getElementById("galleryGrid"),progressFill:document.getElementById("progressFill"),viewerModal:document.getElementById("viewerModal"),btnCloseViewer:document.getElementById("btnCloseViewer"),viewerImg:document.getElementById("viewerImg"),viewerTitle:document.getElementById("viewerTitle"),btnZoomIn:document.getElementById("btnZoomIn"),btnZoomOut:document.getElementById("btnZoomOut"),btnZoomReset:document.getElementById("btnZoomReset"),viewerZoomLabel:document.getElementById("viewerZoomLabel")},O=a.canvas.getContext("2d");O.imageSmoothingEnabled=!1;const r={settings:{darkMode:!1,tileSize:24,haptics:!0,demoMode:!1},progressByImage:{"01":0,"02":0,"03":0,"04":0,"05":0},activeId:"01",isWalking:!1,distanceMeters:0,lastLatLng:null,watchTimer:null,image:null,unlockAnimating:!1,tileOrder:[]};let B=1;function ze(t){B=1,a.viewerImg.style.transform=`scale(${B})`,a.viewerZoomLabel.textContent="100%",a.viewerImg.src=t.src,a.viewerTitle.textContent=`imatge${t.id}`,y(a.viewerModal,!1)}function ee(t){B=k(t,1,4),a.viewerImg.style.transform=`scale(${B})`,a.viewerZoomLabel.textContent=`${Math.round(B*100)}%`}Ve();async function Ve(){Ne(),Ke(),r.activeId=p[0].id,U(),Ze(),await G(),L(),I(),D()}function Ze(){a.btnStartStop.addEventListener("click",async()=>{r.isWalking?Z():await Je()}),a.btnReset.addEventListener("click",async()=>{if(confirm("Vols reiniciar TOT el progrÃ©s? (totes les imatges tornaran a 0%)")){Z(),r.distanceMeters=0,r.lastLatLng=null;for(const e of p)r.progressByImage[e.id]=0;K(),r.activeId=p[0].id,U(),await G(),L(),I(),D()}}),a.btnNext.addEventListener("click",async()=>{r.activeId=tt(r.activeId),U(),await G(),L(),I(),D()}),a.btnSettings.addEventListener("click",()=>y(a.settingsPanel,!1)),a.btnCloseSettings.addEventListener("click",()=>y(a.settingsPanel,!0)),a.togDarkMode.addEventListener("change",()=>{r.settings.darkMode=a.togDarkMode.checked,we(),F()}),a.togHaptics.addEventListener("change",()=>{r.settings.haptics=a.togHaptics.checked,F()}),a.togDemoMode.addEventListener("change",()=>{r.settings.demoMode=a.togDemoMode.checked,a.demoControls.hidden=!r.settings.demoMode,F()}),a.selTileSize.addEventListener("change",async()=>{r.settings.tileSize=Number(a.selTileSize.value),F(),be(),I()}),a.btnAdd50.addEventListener("click",()=>ue(50)),a.btnAdd200.addEventListener("click",()=>ue(200)),a.btnGallery.addEventListener("click",()=>y(a.galleryModal,!1)),a.btnCloseGallery.addEventListener("click",()=>y(a.galleryModal,!0)),a.galleryModal.addEventListener("click",t=>{t.target===a.galleryModal&&y(a.galleryModal,!0)}),a.btnCloseViewer.addEventListener("click",()=>y(a.viewerModal,!0)),a.viewerModal.addEventListener("click",t=>{t.target===a.viewerModal&&y(a.viewerModal,!0)}),a.btnZoomIn.addEventListener("click",()=>ee(B+.25)),a.btnZoomOut.addEventListener("click",()=>ee(B-.25)),a.btnZoomReset.addEventListener("click",()=>ee(1)),window.addEventListener("keydown",t=>{t.key==="Escape"&&(y(a.galleryModal,!0),y(a.settingsPanel,!0),y(a.viewerModal,!0))}),window.addEventListener("resize",()=>I())}function y(t,e){t.hidden=e}function Ne(){try{const e=JSON.parse(localStorage.getItem(ve)||"null");e&&typeof e=="object"&&(r.settings={...r.settings,...e})}catch{}try{const e=JSON.parse(localStorage.getItem(ye)||"null");e&&typeof e=="object"&&(r.progressByImage={...r.progressByImage,...e})}catch{}const t=localStorage.getItem(pe);t&&p.some(e=>e.id===t)&&(r.activeId=t),we()}function F(){localStorage.setItem(ve,JSON.stringify(r.settings))}function K(){localStorage.setItem(ye,JSON.stringify(r.progressByImage))}function U(){localStorage.setItem(pe,r.activeId)}function Ke(){a.togDarkMode.checked=!!r.settings.darkMode,a.togHaptics.checked=!!r.settings.haptics,a.togDemoMode.checked=!!r.settings.demoMode,a.selTileSize.value=String(r.settings.tileSize),a.demoControls.hidden=!r.settings.demoMode}function we(){document.body.classList.toggle("light",!!r.settings.darkMode)}async function G(){const t=p.find(e=>e.id===r.activeId)||p[0];r.activeId=t.id,U(),r.image=await et(t.src),be()}function be(){const t=r.settings.tileSize,e=Math.floor(a.canvas.width/t),n=Math.floor(a.canvas.height/t),i=e*n,s=rt(`imatge${r.activeId}-${t}`),o=ot(s),l=Array.from({length:i},(c,d)=>d);for(let c=l.length-1;c>0;c--){const d=Math.floor(o()*(c+1));[l[c],l[d]]=[l[d],l[c]]}r.tileOrder=l}function L(){a.txtActiveImage.textContent=r.activeId,a.txtMeters.textContent=Math.round(r.distanceMeters).toString();const t=te(),e=Math.round(t*100);a.txtPercent.textContent=e.toString(),a.progressFill&&(a.progressFill.style.width=`${e}%`),a.btnStartStop.textContent=r.isWalking?"Stop":"Start",r.unlockAnimating||(a.badgeStatus.hidden=!0,a.badgeStatus.classList.remove("animate"))}function te(){return k(r.progressByImage[r.activeId]??0,0,1)}function ne(t){r.progressByImage[r.activeId]=k(t,0,1)}function ue(t){r.distanceMeters=k(r.distanceMeters+t,0,R);const e=k(r.distanceMeters/R,0,1);ne(e),L(),I(),K(),e>=1&&Ee()}async function Je(){r.isWalking=!0,L();try{await le.requestPermissions()}catch(t){console.warn("Geolocation permissions request failed:",t)}r.watchTimer=window.setInterval(async()=>{if(r.isWalking)try{const t=await le.getCurrentPosition({enableHighAccuracy:!0,timeout:5e3}),e=t.coords.latitude,n=t.coords.longitude,i={lat:e,lng:n};if(r.lastLatLng){const s=nt(r.lastLatLng,i);if(s>.5&&s<50){r.distanceMeters=k(r.distanceMeters+s,0,R);const o=k(r.distanceMeters/R,0,1);ne(o),K()}}r.lastLatLng=i,L(),I(),te()>=1&&Ee()}catch(t){console.warn("Geolocation getCurrentPosition error:",t)}},2500)}function Z(){r.isWalking=!1,r.watchTimer&&(clearInterval(r.watchTimer),r.watchTimer=null),L()}async function Ee(){if(r._unlocking)return;r._unlocking=!0,Z(),ne(1),r.distanceMeters=R,K(),L(),I(),D(),r.unlockAnimating=!0,a.badgeStatus.hidden=!1,a.badgeStatus.classList.add("animate"),await Ye(1e3),a.badgeStatus.hidden=!0,a.badgeStatus.classList.remove("animate"),r.unlockAnimating=!1;const t=p.find(e=>(r.progressByImage[e.id]??0)<1);if(!t){setTimeout(async()=>{await ge(H.Heavy),alert("Has desbloquejat totes les imatges d'aquesta DEMO! Enhorabona!"),r._unlocking=!1},200);return}setTimeout(async()=>{r.activeId=t.id,U(),r.distanceMeters=0,r.lastLatLng=null,await G(),L(),I(),D(),await ge(H.Light),r._unlocking=!1},400)}async function Ye(t){if(!r.settings.haptics)return;const e=Date.now();return new Promise(n=>{const i=async()=>{if(Date.now()-e>=t){clearInterval(s),n();return}try{z.vibrate?await z.vibrate({duration:150}):await z.impact({style:H.Light})}catch{}},s=setInterval(()=>{i()},180);i()})}async function ge(t){if(r.settings.haptics)try{await z.impact({style:t})}catch{}}function I(){if(!r.image)return;const t=a.canvas.width,e=a.canvas.height;Qe(r.image);const n=r.settings.tileSize,i=Math.floor(t/n),s=Math.floor(e/n),o=i*s,l=te(),c=Math.floor(l*o);for(let d=0;d<c;d++){const u=r.tileOrder[d],w=u%i,f=Math.floor(u/i),E=w*n,T=f*n;O.drawImage(r.image,E,T,n,n,E,T,n,n)}}function Qe(t){const e=a.canvas.width,n=a.canvas.height,i=.05,s=Math.max(1,Math.floor(e*i)),o=Math.max(1,Math.floor(n*i)),l=Xe(s,o),c=l.getContext("2d");c.imageSmoothingEnabled=!0,c.clearRect(0,0,s,o),c.drawImage(t,0,0,s,o),O.save(),O.imageSmoothingEnabled=!1,O.clearRect(0,0,e,n),O.drawImage(l,0,0,s,o,0,0,e,n),O.restore()}let A=null;function Xe(t,e){return(!A||A.width!==t||A.height!==e)&&(A=document.createElement("canvas"),A.width=t,A.height=e),A}function et(t){return new Promise((e,n)=>{const i=new Image;i.onload=()=>e(i),i.onerror=s=>n(s),i.src=t})}function D(){a.galleryGrid.innerHTML="";for(const t of p){const e=k(r.progressByImage[t.id]??0,0,1),n=e>=1,i=document.createElement("div");i.className="thumb",i.title=n?"Desbloquejada":`Bloquejada (${Math.round(e*100)}%)`;const s=document.createElement("img");if(s.src=t.src,s.alt=`imatge${t.id}`,i.appendChild(s),!n){const l=document.createElement("div");l.className="overlay",l.textContent="ðŸ”’",i.appendChild(l)}const o=document.createElement("div");o.className="pct",o.textContent=`${Math.round(e*100)}%`,i.appendChild(o),i.addEventListener("click",async()=>{if(k(r.progressByImage[t.id]??0,0,1)>=1){y(a.galleryModal,!0),ze(t);return}Z(),r.unlockAnimating=!1,a.badgeStatus.hidden=!0,a.badgeStatus.classList.remove("animate"),r.activeId=t.id,U(),r.distanceMeters=Math.round((r.progressByImage[t.id]??0)*R),r.lastLatLng=null,await G(),L(),I(),y(a.galleryModal,!0)}),a.galleryGrid.appendChild(i)}}function tt(t){const e=p.findIndex(n=>n.id===t);return e===-1?p[0].id:p[(e+1)%p.length].id}function k(t,e,n){return Math.max(e,Math.min(n,t))}function nt(t,e){const i=E=>E*Math.PI/180,s=i(e.lat-t.lat),o=i(e.lng-t.lng),l=i(t.lat),c=i(e.lat),d=Math.sin(s/2),u=Math.sin(o/2),w=d*d+Math.cos(l)*Math.cos(c)*u*u;return 6371e3*(2*Math.atan2(Math.sqrt(w),Math.sqrt(1-w)))}function rt(t){let e=2166136261;for(let n=0;n<t.length;n++)e^=t.charCodeAt(n),e=Math.imul(e,16777619);return e>>>0}function ot(t){let e=t>>>0;return function(){e|=0,e=e+1831565813|0;let n=Math.imul(e^e>>>15,1|e);return n=n+Math.imul(n^n>>>7,61|n)^n,((n^n>>>14)>>>0)/4294967296}}export{H as I,de as N,he as W};
